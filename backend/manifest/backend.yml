name: FlavorFind
description: A platform to discover restaurants, browse menus, and share reviews.

entities:
  User:
    authenticable: true
    properties:
      - name
      - { name: email, type: email, options: { required: true, unique: true } }
      - { name: role, type: choice, options: { values: [admin, owner, user], default: user } }
    policies:
      create:
        - access: admin
      read:
        - access: public # Allow reading user profiles, e.g., for review authors
      update:
        - { access: restricted, allow: User, condition: self }
      delete:
        - access: admin
      signup:
        - access: public

  Restaurant:
    properties:
      - { name: name, type: string, options: { required: true } }
      - { name: description, type: text }
      - { name: address, type: string }
      - { name: photo, type: image, options: { sizes: { thumbnail: { width: 400, height: 300 } } } }
      - { name: cuisine, type: choice, options: { values: [Italian, Mexican, Japanese, Indian, American, Other] } }
    belongsTo:
      - { name: owner, entity: User }
    policies:
      create:
        - { access: restricted, allow: User }
      read:
        - access: public
      update:
        - { access: restricted, allow: User, condition: self }
      delete:
        - { access: restricted, allow: User, condition: self }

  MenuItem:
    properties:
      - { name: name, type: string, options: { required: true } }
      - { name: description, type: text }
      - { name: price, type: money, options: { currency: 'USD', required: true } }
      - { name: category, type: choice, options: { values: [Appetizer, Main, Dessert, Beverage], default: Main } }
      - { name: photo, type: image, options: { sizes: { thumbnail: { width: 200, height: 200 } } } }
    belongsTo:
      - { name: restaurant, entity: Restaurant }
    policies:
      create:
        - { access: restricted, allow: User } # Further logic handled in frontend to check for restaurant ownership
      read:
        - access: public
      update:
        - { access: restricted, allow: User } # Frontend logic check
      delete:
        - { access: restricted, allow: User } # Frontend logic check

  Review:
    properties:
      - { name: rating, type: number, options: { min: 1, max: 5, required: true } }
      - { name: comment, type: text }
    belongsTo:
      - { name: author, entity: User }
      - { name: restaurant, entity: Restaurant }
    policies:
      create:
        - { access: restricted, allow: User }
      read:
        - access: public
      update:
        - { access: restricted, allow: User, condition: self }
      delete:
        - { access: restricted, allow: User, condition: self }


# Health check endpoint for connection testing
endpoints:
  healthCheck:
    path: /api/health
    method: GET
    handler: healthCheck
    policies: []  # Public access for health checks